%% SANDBOX
% Solutions from Complete model:

%                                              R E A L   E I G E N V A L U E S
%   MODE    EXTRACTION      EIGENVALUE            RADIANS             CYCLES            GENERALIZED         GENERALIZED
%    NO.       ORDER                                                                       MASS              STIFFNESS
sol_f = [
        1         1       -2.645234E-04        1.626418E-02        2.588524E-03        5.276874E-01       -1.395857E-04;
        2         2       -2.825425E-05        5.315473E-03        8.459837E-04        5.456105E+00       -1.541582E-04;
        3         3       -2.103864E-05        4.586790E-03        7.300103E-04        4.653615E+00       -9.790574E-05;
        4         4       -2.041382E-05        4.518165E-03        7.190883E-04        2.150020E+00       -4.389010E-05;
        5         5        4.846765E-08        2.201537E-04        3.503855E-05        1.943211E+00        9.418290E-08;
        6         6        4.496649E-06        2.120530E-03        3.374929E-04        6.149281E+00        2.765116E-05;
        7         7        9.349195E+02        3.057645E+01        4.866394E+00        1.670917E-01        1.562173E+02;
        8         8        1.319798E+03        3.632903E+01        5.781945E+00        3.267720E-01        4.312731E+02;
        9         9        3.219607E+03        5.674158E+01        9.030704E+00        3.257624E-01        1.048827E+03;
       10        10        3.819067E+03        6.179860E+01        9.835553E+00        1.648986E-01        6.297588E+02;
       11        11        4.370055E+03        6.610639E+01        1.052116E+01        2.998510E-01        1.310366E+03;
       12        12        4.805988E+03        6.932524E+01        1.103345E+01        3.829217E-01        1.840317E+03;
       13        13        6.637374E+03        8.147008E+01        1.296637E+01        2.010675E-01        1.334561E+03;
       14        14        6.650984E+03        8.155356E+01        1.297965E+01        2.085094E-01        1.386793E+03;
       15        15        8.556897E+03        9.250349E+01        1.472239E+01        1.684554E+00        1.441455E+04;
       16        16        9.804963E+03        9.902001E+01        1.575952E+01        7.642062E-02        7.493014E+02;
       17        17        9.815649E+03        9.907396E+01        1.576811E+01        7.468747E-02        7.331060E+02;
       18        18        1.386130E+04        1.177340E+02        1.873795E+01        3.293302E-01        4.564944E+03;
       19        19        1.527340E+04        1.235856E+02        1.966926E+01        4.365817E-02        6.668087E+02;
       20        20        1.531728E+04        1.237630E+02        1.969750E+01        4.238991E-02        6.492982E+02;
       21        21        1.843076E+04        1.357599E+02        2.160687E+01        2.570485E-01        4.737600E+03;
       22        22        1.889239E+04        1.374496E+02        2.187578E+01        1.071454E-01        2.024232E+03;
       23        23        2.035901E+04        1.426850E+02        2.270902E+01        1.196820E-01        2.436606E+03;
       24        24        2.121623E+04        1.456579E+02        2.318218E+01        1.179674E-01        2.502824E+03;
       25        25        2.485445E+04        1.576529E+02        2.509125E+01        1.150117E-01        2.858552E+03;
       26        26        3.143181E+04        1.772902E+02        2.821661E+01        2.173565E-01        6.831910E+03;
       27        27        3.188449E+04        1.785623E+02        2.841907E+01        5.824249E-01        1.857033E+04;
       28        28        5.399432E+04        2.323668E+02        3.698232E+01        1.115632E-01        6.023779E+03;
       29        29        7.003313E+04        2.646377E+02        4.211840E+01        6.851316E-01        4.798191E+04;
       30        30        8.069403E+04        2.840669E+02        4.521066E+01        8.138505E-01        6.567288E+04;
       31        31        8.286972E+04        2.878710E+02        4.581609E+01        8.928220E-01        7.398790E+04;
       32        32        9.531087E+04        3.087246E+02        4.913504E+01        1.831240E-01        1.745371E+04];

% From Symmetric model:

   %                                            R E A L   E I G E N V A L U E S
   % MODE    EXTRACTION      EIGENVALUE            RADIANS             CYCLES            GENERALIZED         GENERALIZED
   %  NO.       ORDER                                                                       MASS              STIFFNESS
sol_s = [   
        1         1       -4.822193E-05        6.944201E-03        1.105204E-03        3.443571E+00       -1.660556E-04;
        2         2       -1.305305E-05        3.612901E-03        5.750111E-04        3.777619E+00       -4.930947E-05;
        3         3       -2.813809E-06        1.677441E-03        2.669731E-04        9.078098E-01       -2.554403E-06;
        4         4        9.358926E+02        3.059236E+01        4.868926E+00        8.319331E-02        7.786001E+01;
        5         5        3.857844E+03        6.211155E+01        9.885360E+00        7.881841E-02        3.040691E+02;
        6         6        4.392440E+03        6.627549E+01        1.054807E+01        1.432616E-01        6.292678E+02;
        7         7        6.632692E+03        8.144134E+01        1.296179E+01        1.005257E-01        6.667560E+02;
        8         8        9.794206E+03        9.896568E+01        1.575088E+01        3.804240E-02        3.725951E+02;
        9         9        1.463990E+04        1.209955E+02        1.925703E+01        1.323352E-01        1.937375E+03;
       10        10        1.547416E+04        1.243952E+02        1.979811E+01        2.535035E-02        3.922753E+02;
       11        11        1.895421E+04        1.376743E+02        2.191154E+01        5.619708E-02        1.065171E+03;
       12        12        2.615474E+04        1.617243E+02        2.573922E+01        4.099306E-02        1.072163E+03;
       13        13        4.831093E+04        2.197975E+02        3.498186E+01        4.868906E-01        2.352214E+04;
       14        14        8.046614E+04        2.836655E+02        4.514677E+01        4.203071E-01        3.382049E+04];

% Solutions of Antysymmetric model:
   %                                            R E A L   E I G E N V A L U E S
   % MODE    EXTRACTION      EIGENVALUE            RADIANS             CYCLES            GENERALIZED         GENERALIZED
   %  NO.       ORDER                                                                       MASS              STIFFNESS
sol_a = [
        1         1       -4.591920E-05        6.776371E-03        1.078493E-03        2.732909E-01       -1.254930E-05;
        2         2       -9.897505E-06        3.146030E-03        5.007062E-04        8.038075E-01       -7.955689E-06;
        3         3       -2.611367E-06        1.615972E-03        2.571900E-04        2.824869E+00       -7.376769E-06;
        4         4        1.331761E+03        3.649329E+01        5.808088E+00        1.624202E-01        2.163048E+02;
        5         5        3.223830E+03        5.677878E+01        9.036623E+00        1.649836E-01        5.318790E+02;
        6         6        4.852273E+03        6.965826E+01        1.108646E+01        1.934665E-01        9.387520E+02;
        7         7        6.719181E+03        8.197061E+01        1.304603E+01        1.032211E-01        6.935615E+02;
        8         8        9.800460E+03        9.899727E+01        1.575591E+01        3.849827E-02        3.773008E+02;
        9         9        1.495286E+04        1.222819E+02        1.946177E+01        2.678227E-02        4.004715E+02;
       10        10        1.598747E+04        1.264416E+02        2.012380E+01        8.559531E-02        1.368452E+03;
       11        11        2.045712E+04        1.430284E+02        2.276368E+01        4.284404E-02        8.764658E+02;
       12        12        2.206573E+04        1.485454E+02        2.364173E+01        1.458254E-01        3.217745E+03;
       13        13        3.987387E+04        1.996844E+02        3.178076E+01        2.575864E-02        1.027097E+03;
       14        14        4.789784E+04        2.188557E+02        3.483197E+01        7.986964E-02        3.825583E+03;
       15        15        5.939636E+04        2.437137E+02        3.878824E+01        1.290114E-01        7.662810E+03;
       16        16        7.714004E+04        2.777410E+02        4.420385E+01        3.162964E-01        2.439912E+04;
       17        17        8.438793E+04        2.904960E+02        4.623388E+01        2.375129E-01        2.004322E+04];

%%
Nf = length(sol_f(:,1))% 32
Ns = length(sol_s(:,1))% 14
Na = length(sol_a(:,1))% 17

base_s = zeros(Ns,1);
base_a = zeros(Na,1);

s_idx = 1;
a_idx = 1;
for k=1:Nf
    freq_s = sol_s(s_idx,5);
    freq_a = sol_a(a_idx,5);
    if freq_s < freq_a
        base_s(s_idx) = k;
        if s_idx < Ns
            s_idx = s_idx + 1;
        end
    else 
        base_a(a_idx) = k;
        if a_idx < Na
            a_idx = a_idx + 1;
        end
    end
end
%%
figure(1)
subplot(1,3,1)
plot(sol_f(:,1),sol_f(:,5), '-s')
subplot(1,3,2)
plot(base_s(:,1),sol_s(:,5), '-s')
subplot(1,3,3)
plot(base_a(:,1),sol_a(:,5), '-s')
